<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C1 Advanced Grammar Practice</title>
    <style>
        :root {
            --primary: #3498db;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        
        h1 {
            color: var(--dark);
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .question-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            position: relative;
        }
        
        .question-number {
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .question-text {
            font-weight: 600;
            margin-bottom: 20px;
            font-size: 18px;
            padding-top: 10px;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .option {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 15px;
        }
        
        .option:hover {
            background-color: #f0f8ff;
            border-color: var(--primary);
        }
        
        .option.selected {
            border-color: var(--primary);
            background-color: #e1f0fa;
            font-weight: 500;
        }
        
        .option.correct {
            border-color: var(--success);
            background-color: #e8f8f0;
        }
        
        .option.incorrect {
            border-color: var(--danger);
            background-color: #fdecea;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: var(--gray);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #d35400;
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
            display: none;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .correct-feedback {
            background-color: #e8f8f0;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .incorrect-feedback {
            background-color: #fdecea;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .explanation {
            margin-top: 10px;
            font-style: italic;
            color: #5a6268;
            font-size: 14px;
        }
        
        .progress-container {
            margin-bottom: 30px;
            background-color: #ecf0f1;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 10px;
            background-color: var(--primary);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .score-container {
            text-align: center;
            margin-top: 30px;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .score {
            font-size: 28px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        .score-message {
            font-size: 18px;
            margin-bottom: 25px;
            color: #5a6268;
        }
        
        .restart-btn {
            padding: 12px 25px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .restart-btn:hover {
            background-color: #2980b9;
        }
        
        .hidden {
            display: none;
        }
        
        .disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <h1>C1 Advanced Grammar Practice</h1>
    
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div id="quizContainer">
        <div class="question-container">
            <div class="question-number" id="questionNumber">1</div>
            <div class="question-text" id="questionText"></div>
            <div class="options" id="optionsContainer"></div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="submitBtn">SUBMIT</button>
                <button class="btn btn-warning" id="answerBtn">ANSWER</button>
                <button class="btn btn-success" id="nextBtn">NEXT</button>
                <button class="btn btn-sm btn-secondary" id="returnBtn">RETURN</button>
            </div>
            
            <div class="feedback" id="feedback"></div>
        </div>
    </div>
    
    <div class="score-container" id="scoreContainer">
        <div class="score">Your score: <span id="finalScore">0</span>/40</div>
        <div class="score-message" id="scoreMessage"></div>
        <button class="restart-btn" id="restartBtn">BACK TO THE START</button>
    </div>
    
    <script>
        const questions = [
            // Prepositions (5 questions)
            {
                question: "She has a remarkable ability to adapt ____ new situations quickly.",
                options: ["at", "to", "with", "for"],
                answer: 1,
                explanation: "The correct preposition is 'to' - 'adapt to' is the correct collocation."
            },
            {
                question: "The research team was commended ____ their groundbreaking discovery.",
                options: ["for", "on", "about", "with"],
                answer: 0,
                explanation: "The correct preposition is 'for' - 'commended for' is the correct collocation."
            },
            {
                question: "His argument was based ____ flawed assumptions from the outset.",
                options: ["in", "on", "at", "by"],
                answer: 1,
                explanation: "The correct preposition is 'on' - 'based on' is the correct collocation."
            },
            {
                question: "We need to focus ____ improving customer satisfaction this quarter.",
                options: ["in", "on", "at", "with"],
                answer: 1,
                explanation: "The correct preposition is 'on' - 'focus on' is the correct collocation."
            },
            {
                question: "The company is highly regarded ____ its innovative approach to problem-solving.",
                options: ["for", "by", "with", "at"],
                answer: 0,
                explanation: "The correct preposition is 'for' - 'regarded for' is the correct collocation."
            },
            
            // Adjectives (4 questions)
            {
                question: "The ____ landscape took our breath away as we reached the mountain summit.",
                options: ["spectacular", "spectacularly", "spectacle", "spectating"],
                answer: 0,
                explanation: "The correct answer is 'spectacular' - we need an adjective to describe the landscape."
            },
            {
                question: "Her ____ attention to detail makes her an excellent editor.",
                options: ["meticulous", "meticulously", "meticulousness", "meticulate"],
                answer: 0,
                explanation: "The correct answer is 'meticulous' - we need an adjective to describe her attention."
            },
            {
                question: "The proposal was rejected as being ____ unrealistic given the current budget constraints.",
                options: ["utter", "utterly", "uttering", "uttered"],
                answer: 1,
                explanation: "The correct answer is 'utterly' - we need an adverb to modify the adjective 'unrealistic'."
            },
            {
                question: "His ____ behavior during the crisis earned him widespread admiration.",
                options: ["commendable", "commended", "commending", "commendably"],
                answer: 0,
                explanation: "The correct answer is 'commendable' - we need an adjective to describe his behavior."
            },
            
            // Relative pronouns (3 questions)
            {
                question: "The scientist, ____ research has revolutionized the field, will be giving a lecture next week.",
                options: ["who", "whose", "whom", "which"],
                answer: 1,
                explanation: "The correct answer is 'whose' - we need a possessive relative pronoun for 'research'."
            },
            {
                question: "This is the village ____ I spent my childhood summers.",
                options: ["where", "which", "who", "when"],
                answer: 0,
                explanation: "The correct answer is 'where' - we need a relative pronoun referring to a place."
            },
            {
                question: "The documents ____ you requested have been prepared and are ready for collection.",
                options: ["who", "whose", "which", "whom"],
                answer: 2,
                explanation: "The correct answer is 'which' - we need a relative pronoun referring to objects (documents)."
            },
            
            // Linking words/connectors (4 questions)
            {
                question: "The experiment yielded unexpected results; ____, it opened up new avenues for research.",
                options: ["however", "nevertheless", "consequently", "furthermore"],
                answer: 2,
                explanation: "The correct answer is 'consequently' - showing a result relationship between the clauses."
            },
            {
                question: "____ the initial setbacks, the project was ultimately completed on time and within budget.",
                options: ["Despite", "Although", "Because of", "Whereas"],
                answer: 0,
                explanation: "The correct answer is 'Despite' - showing contrast with the initial setbacks."
            },
            {
                question: "The data was inconclusive; ____, we cannot draw any definitive conclusions at this stage.",
                options: ["therefore", "however", "moreover", "nevertheless"],
                answer: 0,
                explanation: "The correct answer is 'therefore' - showing a logical conclusion from the first clause."
            },
            {
                question: "____ the complexity of the issue, we must approach it systematically and carefully.",
                options: ["Given", "Unless", "Whereas", "Lest"],
                answer: 0,
                explanation: "The correct answer is 'Given' - meaning 'considering' or 'taking into account'."
            },
            
            // Phrasal verbs (4 questions)
            {
                question: "After much deliberation, we decided to ____ the new marketing strategy.",
                options: ["go after", "go over", "go ahead with", "go back on"],
                answer: 2,
                explanation: "The correct answer is 'go ahead with' - meaning to proceed with something."
            },
            {
                question: "The committee will ____ the applications and notify successful candidates by Friday.",
                options: ["look into", "look after", "look over", "look forward to"],
                answer: 2,
                explanation: "The correct answer is 'look over' - meaning to examine or review something."
            },
            {
                question: "We need to ____ the problem before we can find an effective solution.",
                options: ["get across", "get around", "get at", "get by"],
                answer: 2,
                explanation: "The correct answer is 'get at' - meaning to discover or understand something."
            },
            {
                question: "The company had to ____ several obstacles before the product could be launched.",
                options: ["come across", "come up against", "come into", "come round to"],
                answer: 1,
                explanation: "The correct answer is 'come up against' - meaning to encounter difficulties."
            },
            
            // Past modals (3 questions)
            {
                question: "You ____ told me you were coming - I would have prepared something special for dinner!",
                options: ["must have", "could have", "should have", "might have"],
                answer: 2,
                explanation: "The correct answer is 'should have' - expressing a missed obligation or expectation."
            },
            {
                question: "The lights are off - they ____ left the office already.",
                options: ["must have", "should have", "would have", "might have"],
                answer: 0,
                explanation: "The correct answer is 'must have' - expressing a logical deduction about the past."
            },
            {
                question: "I ____ finished the report yesterday, but I was called away to an emergency meeting.",
                options: ["must have", "could have", "should have", "would have"],
                answer: 1,
                explanation: "The correct answer is 'could have' - expressing past possibility that didn't happen."
            },
            
            // Perfect tenses (4 questions)
            {
                question: "By the time we arrived at the venue, the keynote speaker ____ her presentation.",
                options: ["has finished", "had finished", "finished", "was finishing"],
                answer: 1,
                explanation: "The correct answer is 'had finished' - past perfect for an action completed before another past action."
            },
            {
                question: "Next month, I ____ working here for exactly ten years.",
                options: ["will be", "will have been", "have been", "had been"],
                answer: 1,
                explanation: "The correct answer is 'will have been' - future perfect continuous for duration up to a future point."
            },
            {
                question: "She ____ in London for three years before moving to New York.",
                options: ["has lived", "had lived", "was living", "lived"],
                answer: 1,
                explanation: "The correct answer is 'had lived' - past perfect for duration before another past action."
            },
            {
                question: "By 2025, scientists ____ a cure for this disease, according to current projections.",
                options: ["will discover", "will be discovering", "will have discovered", "are discovering"],
                answer: 2,
                explanation: "The correct answer is 'will have discovered' - future perfect for completion before a future time."
            },
            
            // Collocations (4 questions)
            {
                question: "The new policy has ____ a significant impact on small businesses.",
                options: ["done", "had", "made", "taken"],
                answer: 1,
                explanation: "The correct answer is 'had' - 'have an impact' is the correct collocation."
            },
            {
                question: "We need to ____ advantage of this opportunity before it's too late.",
                options: ["make", "take", "have", "do"],
                answer: 1,
                explanation: "The correct answer is 'take' - 'take advantage of' is the correct collocation."
            },
            {
                question: "The CEO ____ full responsibility for the company's recent setbacks.",
                options: ["took", "made", "had", "did"],
                answer: 0,
                explanation: "The correct answer is 'took' - 'take responsibility' is the correct collocation."
            },
            {
                question: "The research team ____ great strides in understanding the disease mechanism.",
                options: ["did", "made", "had", "took"],
                answer: 1,
                explanation: "The correct answer is 'made' - 'make strides' is the correct collocation."
            },
            
            // Fixed phrases (4 questions)
            {
                question: "____, we managed to complete the project on time despite all the difficulties.",
                options: ["All in all", "By and large", "At the end of the day", "By hook or by crook"],
                answer: 0,
                explanation: "The correct answer is 'All in all' - meaning 'considering everything'."
            },
            {
                question: "The results were disappointing, but ____, we learned a lot from the experience.",
                options: ["at the end", "on the contrary", "in the long run", "on the other hand"],
                answer: 2,
                explanation: "The correct answer is 'in the long run' - meaning 'over an extended period of time'."
            },
            {
                question: "____, I think we should proceed with caution until we have more data.",
                options: ["For the time being", "At times", "In no time", "From time to time"],
                answer: 0,
                explanation: "The correct answer is 'For the time being' - meaning 'for now, temporarily'."
            },
            {
                question: "The negotiations were tough, but ____ we reached an agreement that satisfied both parties.",
                options: ["at last", "at least", "at most", "at once"],
                answer: 0,
                explanation: "The correct answer is 'at last' - meaning 'finally, after much delay'."
            },
            
            // Articles (3 questions)
            {
                question: "She has ____ MBA from Harvard and now works as ____ consultant.",
                options: ["an, a", "a, a", "an, the", "the, a"],
                answer: 0,
                explanation: "The correct answer is 'an, a' - 'an' before vowel sounds (MBA is pronounced 'em-bee-ay'), 'a' before consonant sounds."
            },
            {
                question: "____ United Nations plays ____ crucial role in international diplomacy.",
                options: ["The, a", "A, the", "The, the", "- , a"],
                answer: 0,
                explanation: "The correct answer is 'The, a' - 'the' for specific organizations, 'a' for non-specific roles."
            },
            {
                question: "He's ____ expert in ____ European history, particularly the Renaissance period.",
                options: ["an, -", "a, -", "an, the", "the, a"],
                answer: 0,
                explanation: "The correct answer is 'an, -' - 'an' before vowel sounds, no article before general fields of study."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let userAnswers = Array(questions.length).fill(null);
        let answeredQuestions = Array(questions.length).fill(false);
        
        // DOM elements
        const quizContainer = document.getElementById("quizContainer");
        const questionNumber = document.getElementById("questionNumber");
        const questionText = document.getElementById("questionText");
        const optionsContainer = document.getElementById("optionsContainer");
        const submitBtn = document.getElementById("submitBtn");
        const answerBtn = document.getElementById("answerBtn");
        const nextBtn = document.getElementById("nextBtn");
        const returnBtn = document.getElementById("returnBtn");
        const feedback = document.getElementById("feedback");
        const progressBar = document.getElementById("progressBar");
        const scoreContainer = document.getElementById("scoreContainer");
        const finalScore = document.getElementById("finalScore");
        const scoreMessage = document.getElementById("scoreMessage");
        const restartBtn = document.getElementById("restartBtn");
        
        // Initialize the quiz
        displayQuestion();
        
        function displayQuestion() {
            const question = questions[currentQuestion];
            
            questionNumber.textContent = currentQuestion + 1;
            questionText.textContent = question.question;
            
            optionsContainer.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (userAnswers[currentQuestion] === index) {
                    optionElement.classList.add('selected');
                }
                if (answeredQuestions[currentQuestion]) {
                    if (index === question.answer) {
                        optionElement.classList.add('correct');
                    } else if (index === userAnswers[currentQuestion] && userAnswers[currentQuestion] !== question.answer) {
                        optionElement.classList.add('incorrect');
                    }
                }
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(optionElement);
            });
            
            updateButtonStates();
            updateProgressBar();
        }
        
        function selectOption(optionIndex) {
            if (answeredQuestions[currentQuestion]) return;
            
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
            
            userAnswers[currentQuestion] = optionIndex;
            updateButtonStates();
        }
        
        function updateButtonStates() {
            submitBtn.disabled = userAnswers[currentQuestion] === null || answeredQuestions[currentQuestion];
            answerBtn.disabled = answeredQuestions[currentQuestion];
            nextBtn.disabled = !answeredQuestions[currentQuestion];
            
            if (answeredQuestions[currentQuestion]) {
                submitBtn.classList.add('disabled');
                answerBtn.classList.add('disabled');
                nextBtn.classList.remove('disabled');
            } else {
                submitBtn.classList.toggle('disabled', userAnswers[currentQuestion] === null);
                answerBtn.classList.remove('disabled');
                nextBtn.classList.add('disabled');
            }
            
            returnBtn.style.visibility = currentQuestion > 0 ? 'visible' : 'hidden';
        }
        
        function checkAnswer() {
            if (answeredQuestions[currentQuestion]) return;
            
            const question = questions[currentQuestion];
            const selectedOption = userAnswers[currentQuestion];
            
            if (selectedOption === question.answer) {
                score++;
                feedback.innerHTML = `
                    <div class="correct-feedback">✓ Correct!</div>
                    <div class="explanation">${question.explanation}</div>
                `;
            } else {
                feedback.innerHTML = `
                    <div class="incorrect-feedback">✗ Incorrect</div>
                    <div class="explanation">${question.explanation}</div>
                `;
            }
            
            feedback.style.display = 'block';
            answeredQuestions[currentQuestion] = true;
            
            // Highlight correct and incorrect answers
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                if (index === question.answer) {
                    option.classList.add('correct');
                } else if (index === selectedOption && selectedOption !== question.answer) {
                    option.classList.add('incorrect');
                }
            });
            
            updateButtonStates();
        }
        
        function showAnswer() {
            if (answeredQuestions[currentQuestion]) return;
            
            const question = questions[currentQuestion];
            userAnswers[currentQuestion] = question.answer;
            answeredQuestions[currentQuestion] = true;
            
            feedback.innerHTML = `
                <div class="correct-feedback">The correct answer is ${String.fromCharCode(65 + question.answer)}. ${question.options[question.answer]}</div>
                <div class="explanation">${question.explanation}</div>
            `;
            feedback.style.display = 'block';
            
            displayQuestion();
        }
        
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
                feedback.style.display = 'none';
            } else {
                showFinalScore();
            }
        }
        
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
                feedback.style.display = 'none';
            }
        }
        
        function updateProgressBar() {
            const progress = ((currentQuestion) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        function showFinalScore() {
            quizContainer.classList.add('hidden');
            progressBar.style.width = '100%';
            
            finalScore.textContent = score;
            const percentage = Math.round((score / questions.length) * 100);
            
            if (percentage >= 80) {
                scoreMessage.textContent = "Excellent work! You've mastered these grammar points.";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Good job! You're well on your way to mastery.";
            } else {
                scoreMessage.textContent = "Keep practicing! Review the explanations to improve.";
            }
            
            scoreContainer.style.display = 'block';
        }
        
        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            userAnswers = Array(questions.length).fill(null);
            answeredQuestions = Array(questions.length).fill(false);
            
            quizContainer.classList.remove('hidden');
            scoreContainer.style.display = 'none';
            feedback.style.display = 'none';
            
            displayQuestion();
        }
        
        // Event listeners
        submitBtn.addEventListener('click', checkAnswer);
        answerBtn.addEventListener('click', showAnswer);
        nextBtn.addEventListener('click', nextQuestion);
        returnBtn.addEventListener('click', prevQuestion);
        restartBtn.addEventListener('click', restartQuiz);
    </script>
</body>
</html>
